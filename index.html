<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5.0, user-scalable=yes"/>
<title>Grant Exchange - OSRS Charting Tool</title>
<meta name="description" content="Advanced charting tool for OSRS Grand Exchange items with indicators like Ichimoku Cloud, Volume Profile, and Volume. Analyze trends from 1 day to 5 years.">
<meta name="keywords" content="OSRS Grand Exchange, OSRS GE, RuneScape Grand Exchange, OSRS charting, OSRS price charts, OSRS indicators, Ichimoku Cloud OSRS, Volume Profile OSRS">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://grantexchange.net/">
<!-- Open Graph -->
<meta property="og:title" content="Grant Exchange - OSRS Charting Tool">
<meta property="og:description" content="Advanced charting tool for OSRS Grand Exchange items with indicators like Ichimoku Cloud, Volume Profile, and Volume. Analyze trends from 1 day to 5 years.">
<meta property="og:image" content="https://oldschool.runescape.wiki/images/Gilded_scimitar.png">
<meta property="og:url" content="https://grantexchange.net/">
<meta property="og:type" content="website">
<!-- Favicon -->
<link rel="icon" type="image/png" sizes="48x48" href="https://oldschool.runescape.wiki/images/Gilded_scimitar.png">
<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Grant Exchange - OSRS Charting Tool">
<meta name="twitter:description" content="Advanced charting tool for OSRS Grand Exchange items with indicators like Ichimoku Cloud, Volume Profile, and Volume. Analyze trends from 1 day to 5 years.">
<meta name="twitter:image" content="https://oldschool.runescape.wiki/images/Gilded_scimitar.png">
<!-- Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-43YM2RCX1R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-43YM2RCX1R');
</script>
<!-- CSS (Darkened RuneScape theme) -->
<style>
:root{
  --bg:#0f0a05; --panel:#1f170a; --edge:#5a3f1b;
  --gold:#b0935a; --orange:#d09010; --ink:#d5c5af; --muted:#ab9f79;
  --low-color:#db4a4a; --high-color:#4ca75a; --grid:#2b1f09; --accent:#efbe3f; --shadow:#050301;
  --teal: #00d5d5;
}
* {box-sizing:border-box}
html,body{height:100%; margin:0; padding:0;}
body{
  background:radial-gradient(1200px 600px at 20% -10%,#1f170a 0%,#0f0a05 60%),#0f0a05;
  color:var(--ink);
  font-family:Segoe UI,Inter,system-ui,Arial;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}
/* Layout */
.wrap{max-width:none; margin:0; padding:10px; height:100vh;
  display:flex; flex-direction:column;}
.header{display:flex; align-items:center; gap:12px; margin-bottom:10px;}
h1{margin:0;font-size:24px;font-weight:900;color:var(--orange);text-shadow:0 1px 0 #000;cursor:pointer}
.badge{font-size:11px;border:1px solid var(--edge);border-radius:999px;
  padding:1px 6px;color:var(--muted);background:#10090e}
.small{font-size:11px;color:var(--muted)}
/* Search Bar with Item Photo */
.sbar{display:flex;align-items:center;gap:8px;background:var(--panel);padding:8px;border-radius:12px;border:1px solid var(--edge);}
.sbar img{width:32px;height:32px;object-fit:contain;image-rendering:pixelated;border-radius:4px;background:#151008;}
.sbar input{flex:1;background:transparent;border:none;color:var(--ink);font-size:18px;outline:none;}
.sbar input::placeholder{color:var(--muted);}
/* Suggest */
.suggest{position:absolute;top:100%;left:0;width:100%;max-height:300px;overflow:auto;background:var(--panel);border:1px solid var(--edge);border-radius:10px;z-index:10;margin-top:4px;}
.suggest div{padding:8px;cursor:pointer;}
.suggest div:hover{background:var(--grid);}
/* Tools Row */
.refreshRow{display:flex;align-items:center;gap:8px;flex-wrap:wrap;margin-bottom:10px;}
.viewtabs, .tools{display:flex;gap:4px;}
.viewtabs button, .tools button{background:var(--panel);border:1px solid var(--edge);
  color:var(--ink);border-radius:8px;padding:4px 8px;cursor:pointer;font-size:12px;text-transform:uppercase;font-weight:bold;}
.viewtabs button.active, .tools button.active{background:var(--grid);border-color:var(--orange);}
#indicatorSelect{background:var(--panel);border:1px solid var(--edge);color:var(--ink);padding:4px 8px;border-radius:8px;font-size:12px;}
/* Chart */
.chartWrap{flex:1;position:relative;}
.chart{width:100%;height:100%;background:var(--grid);border:1px solid var(--edge);border-radius:12px;}
.chart-tip{position:absolute;display:none;background:rgba(0,0,0,.85);color:#fff;padding:6px 8px;border-radius:6px;font-size:12px;pointer-events:none;white-space:nowrap;border:1px solid #000;}
.legend{display:flex;gap:8px;font-size:11px;margin-top:4px;color:var(--muted)}
.legend .sell::before{content:"";display:inline-block;width:12px;height:2px;background:var(--low-color);margin-right:4px;border-radius:2px}
.legend .buy::before{content:"";display:inline-block;width:12px;height:2px;background:var(--high-color);margin-right:4px;border-radius:2px}
/* Refresh */
.btn-refresh{padding:4px 8px;border-radius:8px;border:1px solid var(--edge);background:var(--panel);color:var(--gold);font-size:12px;cursor:pointer;}
/* Mobile */
@media (max-width: 768px) {
  .wrap{padding:5px;}
  h1{font-size:20px;}
  .sbar input{font-size:16px;}
  .viewtabs button, .tools button{font-size:10px;padding:3px 6px;}
  #indicatorSelect{font-size:10px;}
}
</style>
</head>
<body>
<div class="wrap">
  <div class="header">
    <h1 onclick="location.reload();">Grant Exchange</h1><span class="badge">v3.1</span> <span class="badge">OSRS Charts</span>
    <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
      <div class="mode-pill">
        <button id="btnF2P" class="active">F2P</button>
        <button id="btnMembers">Members</button>
      </div>
    </div>
  </div>
  <div class="sbar">
    <img id="itemImg" src="" alt="Item" style="display:none;">
    <input id="query" placeholder="Search item... e.g., Gilded scimitar" autocomplete="off"/>
    <div id="suggestBox" class="suggest" style="display:none"></div>
  </div>
  <div class="refreshRow">
    <div class="viewtabs">
      <button data-view="1d" class="active">1D</button>
      <button data-view="1w">1W</button>
      <button data-view="1m">1M</button>
      <button data-view="6m">6M</button>
      <button data-view="1y">1Y</button>
      <button data-view="5y">5Y</button>
      <button data-view="all">All</button>
    </div>
    <div class="tools">
      <span>Zoom:</span><button id="zIn">+</button><button id="zOut">-</button>
      <span>Mode:</span>
      <button id="lineMode" class="active">Line</button>
      <button id="dotMode">Scatter</button>
      <span>Indicators:</span>
      <select id="indicatorSelect">
        <option value="ichimoku">Ichimoku Cloud</option>
        <option value="vp">Volume Profile</option>
        <option value="volume">Volume</option>
      </select>
      <button id="addIndicator">Add</button>
    </div>
    <button id="refreshBtn" class="btn-refresh">Refresh</button>
  </div>
  <div class="chartWrap">
    <canvas id="chart" class="chart"></canvas>
    <div id="tip" class="chart-tip"></div>
  </div>
  <div class="legend"><span class="sell">Low (Buy)</span><span class="buy">High (Sell)</span></div>
</div>
<!-- SCRIPT -->
<script>
// ... (keep the same script, but add anti-blur and item img update)
function resizeCanvas() {
  const dpr = window.devicePixelRatio || 1;
  canvas.width = canvas.clientWidth * dpr;
  canvas.height = canvas.clientHeight * dpr;
  ctx.scale(dpr, dpr);
  drawChart(currentSeries);
}
window.addEventListener('resize', resizeCanvas);
// In setItem
$('#itemImg').src = bigIconUrl(m.id);
$('#itemImg').style.display = 'block';
// Call resizeCanvas after boot and on load
resizeCanvas();
// Update Ichimoku colors to standard
// Tenkan: #069af3 (blue), Kijun: #ec2b88 (red), Senkou A: #a1d8a0 (light green), Senkou B: #d8a0a6 (light red), Chikou: #22b14c (green)
// In drawChart, adjust drawSeries colors for ichi
drawSeries(tenkanSlice, '#069af3', 'line');
drawSeries(kijunSlice, '#ec2b88', 'line');
drawSeries(chikouSlice, '#22b14c', 'line');
drawSeries(senkouASlice, '#a1d8a0', 'line');
drawSeries(senkouBSlice, '#d8a0a6', 'line');
// For cloud fill: if a1 > b1 green cloud 'rgba(161,216,160,0.2)', else red 'rgba(216,160,166,0.2)'
context.fillStyle = a1 > b1 ? 'rgba(161,216,160,0.2)' : 'rgba(216,160,166,0.2)';
// ... rest same
</script>
</body>
</html>