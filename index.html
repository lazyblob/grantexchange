<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=0.8, maximum-scale=5.0, user-scalable=yes"/>
<title>Grant Exchange - OSRS Charting Tool</title>
<meta name="description" content="Advanced charting tool for OSRS Grand Exchange items with indicators like Ichimoku Cloud, Volume Profile, and Volume. Analyze trends from 1 day to 5 years.">
<meta name="keywords" content="OSRS Grand Exchange, OSRS GE, RuneScape Grand Exchange, OSRS charting, OSRS price charts, OSRS indicators, Ichimoku Cloud OSRS, Volume Profile OSRS">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://grantexchange.net/">
<!-- Open Graph -->
<meta property="og:title" content="Grant Exchange - OSRS Charting Tool">
<meta property="og:description" content="Advanced charting tool for OSRS Grand Exchange items with indicators like Ichimoku Cloud, Volume Profile, and Volume. Analyze trends from 1 day to 5 years.">
<meta property="og:image" content="https://oldschool.runescape.wiki/images/Gilded_scimitar.png">
<meta property="og:url" content="https://grantexchange.net/">
<meta property="og:type" content="website">
<!-- Favicon -->
<link rel="icon" type="image/png" sizes="48x48" href="https://oldschool.runescape.wiki/images/Gilded_scimitar.png">
<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Grant Exchange - OSRS Charting Tool">
<meta name="twitter:description" content="Advanced charting tool for OSRS Grand Exchange items with indicators like Ichimoku Cloud, Volume Profile, and Volume. Analyze trends from 1 day to 5 years.">
<meta name="twitter:image" content="https://oldschool.runescape.wiki/images/Gilded_scimitar.png">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "Grant Exchange - OSRS Charting Tool",
  "url": "https://grantexchange.net/",
  "description": "Advanced charting tool for OSRS Grand Exchange items with indicators like Ichimoku Cloud, Volume Profile, and Volume. Analyze trends from 1 day to 5 years.",
  "applicationCategory": "Game",
  "operatingSystem": "Web",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  }
}
</script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-43YM2RCX1R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-43YM2RCX1R');
</script>
<!-- CSS -->
<style>
:root{
  --bg:#1b140a; --panel:#2b2110; --edge:#6a4f2b;
  --gold:#cfb36a; --orange:#f0a020; --ink:#eee5cf; --muted:#cbbf99;
  --low-color:#fb6a6a; --high-color:#5cc76a; --grid:#3b2f19; --accent:#ffce4f; --shadow:#0b0703;
  --teal: #00ffff;
  --ichi-tenkan: #069af3; --ichi-kijun: #ec2b88; --ichi-chikou: #22b14c;
  --ichi-senkou-a: #a1d8a0; --ichi-senkou-b: #d8a0a6;
  --cloud-green: rgba(161,216,160,0.2); --cloud-red: rgba(216,160,166,0.2);
}
* {box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:radial-gradient(1200px 600px at 20% -10%,#2b2210 0%,#1b140a 60%),#1b140a;
  color:var(--ink);
  font-family:Segoe UI,Inter,system-ui,Arial;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}
/* Layout */
.wrap{max-width:1280px;margin:18px auto;padding:0 7px; min-height: calc(100vh - 36px);
  display:grid;grid-template-columns:1fr;gap:16px;align-items:start}
.header{grid-column:1 / -1;display:grid;
  grid-template-columns:1fr auto auto;gap:12px;align-items:center}
/* Branding */
h1{margin:0;font-size:26px;font-weight:900;color:var(--orange);text-shadow:0 1px 0 #000;cursor:pointer}
.badge{font-size:12px;border:1px solid var(--edge);border-radius:999px;
  padding:2px 8px;color:var(--muted);background:#20190e}
.small{font-size:12px;color:var(--muted)}
.status-error{color:#ffb4b4}
/* Cards */
.card{background:linear-gradient(180deg,#2d220f 0%, #241b0c 100%);
  border:1px solid var(--edge);border-radius:16px;padding:12px;
  box-shadow:0 6px 18px rgba(0,0,0,.28)}
.left{display:flex;flex-direction:column}
.hr{border:none;border-top:1px solid var(--edge);margin:10px 0}
/* Search */
.label{font-size:26px;color:var(--orange);font-weight:900;margin-bottom:0}
.sbar{display:flex;gap:10px;margin-top:2px;position:relative;align-items:center;}
.sbar img{width:32px;height:32px;object-fit:contain;image-rendering:pixelated;}
.sbar input{
  flex:1;background:#1e170c;border:3px solid var(--edge);color:var(--ink);
  border-radius:14px;padding:16px;font-size:20px;outline:none;
  box-shadow:0 0 0 0 rgba(240,160,32,0);transition:box-shadow .18s,border-color .18s }
.sbar input:focus{border-color:var(--orange);
  box-shadow:0 0 0 4px rgba(240,160,32,0.25)}
.sbar .buy-price, .sbar .sell-price{padding:0 16px;font-size:20px;font-weight:900;}
.sbar .buy-price{color:var(--high-color);}
.sbar .sell-price{color:var(--low-color);}
.suggest{margin-top:6px;border:1px solid var(--edge);border-radius:10px;
  max-height:360px;overflow:auto;background:#231b0d;position:absolute;z-index:10;width:100%; left:0;}
.suggest::-webkit-scrollbar {width:8px; background:var(--panel);}
.suggest::-webkit-scrollbar-thumb {background:var(--edge); border-radius:4px;}
.suggest div{display:flex;align-items:center;gap:6px;
  padding:8px 10px;border-bottom:1px solid #3e3119;cursor:pointer; word-break: break-word; white-space: normal; word-wrap: break-word;}
.suggest div:hover{background:#2d220f}
.suggest img{width:20px;height:20px;image-rendering:pixelated}
/* Tools */
.viewtabs, .mode-pill {display:flex;gap:6px;}
.viewtabs button, .mode-pill button{background:#2b2212;border:1px solid var(--edge);
  color:var(--ink);border-radius:10px;padding:6px 10px;
  cursor:pointer;text-transform:uppercase;font-weight: bold; font-size: 14px;transition:box-shadow .18s,border-color .18s}
.viewtabs button.active, .mode-pill button.active{background:#3a2f17; box-shadow: 0 0 10px rgba(240,160,32,0.8);border-color:var(--orange)}
.tools{display:flex;gap:6px;align-items:center;margin-top:6px}
.tools button{background:#2b2212;border:1px solid var(--edge);
  color:var(--ink);border-radius:10px;padding:5px 9px;cursor:pointer;
  text-transform:uppercase;font-weight: bold; font-size: 14px;transition:box-shadow .18s,border-color .18s}
.tools button.active{background:#3a2f17; box-shadow: 0 0 10px rgba(240,160,32,0.8);border-color:var(--orange)}
/* Chart */
.chartWrap{position:relative}
.chart{
  width:100%;height:500px;
  background:repeating-linear-gradient(to bottom,
    rgba(255,255,255,0.03),rgba(255,255,255,0.03) 1px,
    transparent 1px,transparent 24px),#181208;
  border:1px solid var(--edge);border-radius:12px }
.chart-tip{
  position:absolute;display:none;background:rgba(0,0,0,.85);
  color:#fff;padding:6px 8px;border-radius:6px;font-size:12px;
  pointer-events:none;white-space:nowrap;border:1px solid #000 }
.legend{display:flex;gap:12px;font-size:12px;margin-top:6px;color:var(--muted)}
.legend .sell::before{content:"";display:inline-block;width:14px;height:3px;
  background:var(--low-color);margin-right:6px;border-radius:2px}
.legend .buy::before{content:"";display:inline-block;width:14px;height:3px;
  background:var(--high-color);margin-right:6px;border-radius:2px}
/* Refresh */
.refreshRow{display:flex;align-items:center;gap:12px;margin:6px 0}
.btn-refresh{
  padding:12px 20px;border-radius:18px;border:2px solid var(--edge);
  background:linear-gradient(180deg,#3a2f17 0%,#2b2212 100%);
  color:var(--gold);font-weight:900;cursor:pointer;font-size:16px;
  text-transform:uppercase;letter-spacing:.5px;
  box-shadow:0 4px 12px rgba(0,0,0,.3), inset 0 1px 0 rgba(255,255,255,.5);
  transition:transform .08s ease,filter .12s ease,box-shadow .12s ease }
.btn-refresh:hover{filter:brightness(1.05);
  transform:translateY(-1px);
  box-shadow:0 6px 16px rgba(0,0,0,.4), inset 0 1px 0 rgba(255,255,255,.5)}
.btn-refresh:active{transform:translateY(0);
  box-shadow:0 2px 8px rgba(0,0,0,.2), inset 0 1px 0 rgba(255,255,255,.5)}
/* Key Info */
.key-info{display:grid;grid-template-columns:repeat(auto-fit, minmax(120px, 1fr));gap:10px;margin-top:10px;}
.key-item{background:var(--panel);border:1px solid var(--edge);border-radius:10px;padding:8px;text-align:center;}
.key-label{font-size:12px;color:var(--muted);text-transform:uppercase;}
.key-value{font-size:16px;font-weight:bold;}
.key-value.positive{color:var(--high-color);}
.key-value.negative{color:var(--low-color);}
/* Mobile */
@media (max-width: 768px) {
  .wrap {padding: 0 8px; gap: 10px;}
  h1 {font-size: 20px;}
  .sbar input {padding: 12px; font-size: 16px;}
  .viewtabs button, .mode-pill button {padding: 4px 8px; font-size: 12px;}
  .tools button {padding: 3px 6px; font-size: 12px;}
  .refreshRow {gap: 5px;}
  .btn-refresh {padding: 8px 12px; font-size: 14px;}
  .chart {height: 300px;}
}
</style>
</head>
<body>
<div class="wrap">
  <div class="header">
    <div><h1 onclick="location.reload();">Grant Exchange</h1><span class="badge">v3.1</span> <span class="badge">OSRS Charts</span></div>
    <div id="status" class="small">Ready</div>
    <div style="display:flex;gap:10px;align-items:center">
      <div class="mode-pill" id="modePill">
        <button data-mode="f2p" id="btnF2P" class="active">F2P</button>
        <button data-mode="members" id="btnMembers">Members</button>
      </div>
    </div>
  </div>
  <!-- Main panel -->
  <div class="card left">
    <div class="sbar">
      <img id="itemImg" alt="Item" style="display:none;"/>
      <input id="query" placeholder="Search item..." autocomplete="off"/>
      <div id="buyPrice" class="buy-price">— gp</div>
      <div id="sellPrice" class="sell-price">— gp</div>
      <div id="suggestBox" class="suggest" style="display:none"></div>
    </div>
    <div class="refreshRow">
      <div class="viewtabs">
        <button data-view="1d" class="active">1D</button>
        <button data-view="1w">1W</button>
        <button data-view="1m">1M</button>
        <button data-view="6m">6M</button>
        <button data-view="1y">1Y</button>
        <button data-view="5y">5Y</button>
        <button data-view="all">All</button>
      </div>
      <div class="tools">
        <span class="small">Zoom:</span><button id="zIn">+</button><button id="zOut">-</button>
        <span class="small" style="margin-left:10px">Mode:</span>
        <button id="lineMode" class="active">Line</button>
        <button id="dotMode">Scatter</button>
        <button id="vpBtn">VP</button>
        <button id="ichimokuBtn">Ichimoku</button>
        <button id="volumeBtn">Volume</button>
      </div>
      <button id="refreshBtn" class="btn-refresh">Refresh</button>
    </div>
    <div class="chartWrap">
      <canvas id="chart" class="chart" width="980" height="500"></canvas>
      <div id="tip" class="chart-tip"></div>
    </div>
    <div class="legend"><span class="sell">Low (Buy)</span><span class="buy">High (Sell)</span></div>
    <div class="key-info">
      <div class="key-item">
        <div class="key-label">Buy Price</div>
        <div class="key-value positive" id="keyBuy">—</div>
      </div>
      <div class="key-item">
        <div class="key-label">Sell Price</div>
        <div class="key-value negative" id="keySell">—</div>
      </div>
      <div class="key-item">
        <div class="key-label">Volume</div>
        <div class="key-value" id="keyVolume">—</div>
      </div>
      <div class="key-item">
        <div class="key-label">Limit</div>
        <div class="key-value" id="keyLimit">—</div>
      </div>
      <div class="key-item">
        <div class="key-label">Tax</div>
        <div class="key-value" id="keyTax">—</div>
      </div>
      <div class="key-item">
        <div class="key-label">Margin</div>
        <div class="key-value" id="keyMargin">—</div>
      </div>
      <div class="key-item">
        <div class="key-label">ROI</div>
        <div class="key-value" id="keyROI">—</div>
      </div>
      <div class="key-item">
        <div class="key-label">Potential Profit</div>
        <div class="key-value" id="keyProfit">—</div>
      </div>
    </div>
  </div>
</div>
<script>
// ... (keep the script from previous, add key info update in setItem)
async function getBuyLimit(id) {
  if (buyLimits[id]) return buyLimits[id];
  try {
    const res = await fetch(`./items-json/${id}.json`);
    const data = await res.json();
    buyLimits[id] = data.buy_limit || 10000;
    return buyLimits[id];
  } catch (e) {
    return 10000;
  }
}
// In setItem
const node = latest.data[m.id];
const lo = node?.low ?? 0;
const hi = node?.high ?? 0;
const vol = volumes.data[m.id] ?? 0;
const limit = await getBuyLimit(m.id);
const margin = hi - lo;
const tax = Math.min(5000000, Math.floor(hi * 0.01));
const roi = lo ? (margin / lo * 100).toFixed(2) + '%' : '—';
const profit = (margin - tax) * limit;
$('#buyPrice').textContent = fmtGp(lo);
$('#sellPrice').textContent = fmtGp(hi);
$('#keyBuy').textContent = fmtGp(lo);
$('#keySell').textContent = fmtGp(hi);
$('#keyVolume').textContent = fmtNum(vol);
$('#keyLimit').textContent = fmtNum(limit);
$('#keyTax').textContent = fmtGp(tax);
$('#keyMargin').textContent = fmtGp(margin);
$('#keyROI').textContent = roi;
$('#keyProfit').textContent = fmtGp(profit);
// For indicators, change to buttons
$('#vpBtn').onclick = () => {
  toggleIndicator('vp', $('#vpBtn'));
};
$('#ichimokuBtn').onclick = () => {
  toggleIndicator('ichimoku', $('#ichimokuBtn'));
};
$('#volumeBtn').onclick = () => {
  toggleIndicator('volume', $('#volumeBtn'));
};
function toggleIndicator(ind, btn) {
  if (enabledIndicators.includes(ind)) enabledIndicators = enabledIndicators.filter(i => i !== ind);
  else enabledIndicators.push(ind);
  btn.classList.toggle('active');
  drawChart(currentSeries);
}
// ... rest
</script>
</body>
</html>